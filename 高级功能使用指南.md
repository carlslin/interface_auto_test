# ğŸš€ æ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶ - é«˜çº§åŠŸèƒ½ä½¿ç”¨æŒ‡å—

## ğŸ“‹ åŠŸèƒ½æ¦‚è§ˆ

æœ¬æ¡†æ¶å·²ç»å®Œæ•´æ”¯æŒæ‚¨éœ€æ±‚çš„æ‰€æœ‰åŠŸèƒ½ï¼š

### âœ… å·²å®ç°çš„é«˜çº§åŠŸèƒ½
- ğŸ” **å¤šç§è®¤è¯æ–¹å¼** - Bearer Token, API Key, OAuth2, Basic Auth
- ğŸ”— **ä¾èµ–ç®¡ç†** - æ™ºèƒ½è¯†åˆ«å’Œå¤„ç†æ¥å£ä¾èµ–å…³ç³»
- ğŸ“ **å¤šæ ¼å¼æ”¯æŒ** - Python, Postman, cURL, Insomniaç­‰
- âš ï¸ **ç™»å½•æç¤º** - è‡ªåŠ¨æ£€æµ‹éœ€è¦è®¤è¯çš„æ¥å£å¹¶ç»™å‡ºé…ç½®æç¤º
- ğŸ“ **é…ç½®ä½ç½®æŒ‡å¯¼** - æ˜ç¡®å‘ŠçŸ¥é…ç½®æ–‡ä»¶ä½ç½®å’Œæ ¼å¼
- ğŸ¯ **ä¾èµ–ç­–ç•¥** - é’ˆå¯¹å¤æ‚ä¾èµ–åœºæ™¯çš„æ™ºèƒ½å¤„ç†

## ğŸ” è®¤è¯ç®¡ç†åŠŸèƒ½

### 1. æ”¯æŒçš„è®¤è¯æ–¹å¼

#### Bearer Tokenè®¤è¯
```yaml
# config/auth.yaml
authentication:
  api_auth:
    type: bearer
    login_url: "https://your-api.com/auth/login"
    username: "${AUTH_USERNAME}"
    password: "${AUTH_PASSWORD}"
    token_ttl: 24
    auto_refresh: true
```

#### API Keyè®¤è¯
```yaml
authentication:
  key_auth:
    type: api_key
    api_key: "${API_KEY}"
    header_name: "X-API-Key"
```

#### OAuth2è®¤è¯
```yaml
authentication:
  oauth_auth:
    type: oauth2
    client_id: "${OAUTH_CLIENT_ID}"
    client_secret: "${OAUTH_CLIENT_SECRET}"
    token_url: "https://your-api.com/oauth/token"
    grant_type: "client_credentials"
```

### 2. ç¯å¢ƒå˜é‡é…ç½®
```bash
# .env æ–‡ä»¶
AUTH_USERNAME=your_username
AUTH_PASSWORD=your_password
API_KEY=your-api-key
OAUTH_CLIENT_ID=your_client_id
OAUTH_CLIENT_SECRET=your_client_secret
```

## ğŸ”— ä¾èµ–ç®¡ç†åŠŸèƒ½

### 1. å·¥ä½œæµé…ç½®ç¤ºä¾‹
```yaml
# config/workflow.yaml
workflow:
  scenarios:
    - name: "complete_user_workflow"
      steps:
        - id: "user_login"
          name: "ç”¨æˆ·ç™»å½•"
          method: "POST"
          url: "${base_url}/auth/login"
          auth_required: false
          request_body:
            username: "${test_username}"
            password: "${test_password}"
          data_extraction:
            auth_token: "token"
            user_id: "user.id"
        
        - id: "get_user_profile"
          name: "è·å–ç”¨æˆ·èµ„æ–™"
          method: "GET"
          url: "${base_url}/users/${user_id}"
          auth_required: true
          dependencies: ["user_login"]
          dependency_type: "data"
          headers:
            Authorization: "Bearer @{user_login.extracted.auth_token}"
```

### 2. ä¾èµ–ç±»å‹è¯´æ˜

#### æ•°æ®ä¾èµ– (data)
- éœ€è¦å‰ç½®æ¥å£è¿”å›çš„æ•°æ®ï¼ˆå¦‚ç”¨æˆ·IDã€è®¢å•IDç­‰ï¼‰
- ä½¿ç”¨ `@{step_id.extracted.field}` è¯­æ³•å¼•ç”¨

#### è®¤è¯ä¾èµ– (auth)
- éœ€è¦ç™»å½•è·å–çš„Tokenæˆ–è®¤è¯ä¿¡æ¯
- è‡ªåŠ¨ä¼ é€’è®¤è¯å¤´ä¿¡æ¯

#### åºåˆ—ä¾èµ– (sequence)
- å¿…é¡»æŒ‰ç‰¹å®šé¡ºåºæ‰§è¡Œçš„æ“ä½œ
- å¦‚ï¼šå…ˆåˆ›å»ºèµ„æºï¼Œå†æ›´æ–°ï¼Œæœ€ååˆ é™¤

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### 1. ä»APIæ–‡æ¡£ç”Ÿæˆé«˜çº§æµ‹è¯•

```bash
# åŸºç¡€ç”Ÿæˆï¼ˆåŒ…å«è®¤è¯æ£€æµ‹ï¼‰
python3 -m src.cli.main generate auto-complete \
  -i https://your-api.com/openapi.json \
  -w ./my_api_tests

# ç”Ÿæˆçš„é¡¹ç›®ç»“æ„
my_api_tests/
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ auth.yaml          # è®¤è¯é…ç½®æ¨¡æ¿
â”‚   â”œâ”€â”€ workflow.yaml      # å·¥ä½œæµé…ç½®
â”‚   â””â”€â”€ default.yaml       # åŸºç¡€é…ç½®
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ generated/
â”‚       â””â”€â”€ test_api.py    # ç”Ÿæˆçš„æµ‹è¯•ä»£ç 
â”œâ”€â”€ exports/
â”‚   â””â”€â”€ test_cases.xlsx    # æµ‹è¯•ç”¨ä¾‹æ–‡æ¡£
â””â”€â”€ README.md              # ä½¿ç”¨è¯´æ˜
```

### 2. è®¤è¯é…ç½®æç¤º

å½“æ¡†æ¶æ£€æµ‹åˆ°éœ€è¦è®¤è¯çš„æ¥å£æ—¶ï¼Œä¼šè‡ªåŠ¨æä¾›é…ç½®æç¤ºï¼š

```
ğŸ” æ£€æµ‹åˆ°éœ€è¦è®¤è¯çš„æ¥å£:
   â€¢ POST /admin/users - URLæ¨¡å¼è¡¨æ˜éœ€è¦è®¤è¯
   â€¢ GET /user/profile - URLæ¨¡å¼è¡¨æ˜éœ€è¦è®¤è¯
   â€¢ PUT /user/settings - URLæ¨¡å¼è¡¨æ˜éœ€è¦è®¤è¯

âš ï¸ è®¤è¯é…ç½®å»ºè®®:
   ğŸ“ é…ç½®æ–‡ä»¶ä½ç½®: config/auth.yaml
   ğŸ”§ æ”¯æŒçš„è®¤è¯æ–¹å¼: Bearer Token, API Key, OAuth2, Basic Auth
   ğŸŒ ç¯å¢ƒå˜é‡é…ç½®: .env æ–‡ä»¶
```

### 3. ä¾èµ–åˆ†ææŠ¥å‘Š

æ¡†æ¶ä¼šè‡ªåŠ¨åˆ†æAPIä¾èµ–å…³ç³»ï¼š

```markdown
## ğŸ”— ä¾èµ–å…³ç³»åˆ†æ

### æ½œåœ¨çš„ä¾èµ–å…³ç³»
- **PUT /users/{id}** ä¾èµ–äº **POST /users** - ä¿®æ”¹/åˆ é™¤æ“ä½œéœ€è¦å…ˆåˆ›å»ºèµ„æº
- **DELETE /orders/{id}** ä¾èµ–äº **POST /orders** - ä¿®æ”¹/åˆ é™¤æ“ä½œéœ€è¦å…ˆåˆ›å»ºèµ„æº

### å»ºè®®çš„æµ‹è¯•å·¥ä½œæµ
1. **ç”¨æˆ·è®¤è¯** - è·å–è®¿é—®ä»¤ç‰Œæˆ–å»ºç«‹ä¼šè¯
2. **åŸºç¡€æ•°æ®æŸ¥è¯¢** - éªŒè¯åŸºç¡€æŸ¥è¯¢åŠŸèƒ½
3. **åˆ›å»ºèµ„æº** - åˆ›å»ºæµ‹è¯•æ•°æ®
4. **æ›´æ–°å’Œåˆ é™¤** - éªŒè¯æ•°æ®ä¿®æ”¹åŠŸèƒ½
```

## ğŸ› ï¸ å®é™…æ“ä½œæ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šç”ŸæˆåŸºç¡€é¡¹ç›®
```bash
python3 -m src.cli.main generate auto-complete \
  -i your_api_doc_url_or_file \
  -w ./advanced_api_tests
```

### ç¬¬äºŒæ­¥ï¼šé…ç½®è®¤è¯ä¿¡æ¯
```bash
# ç¼–è¾‘è®¤è¯é…ç½®
vim advanced_api_tests/config/auth.yaml

# æˆ–ä½¿ç”¨ç¯å¢ƒå˜é‡
cp advanced_api_tests/.env.template .env
vim .env
```

### ç¬¬ä¸‰æ­¥ï¼šé…ç½®å·¥ä½œæµä¾èµ–
```bash
# æ ¹æ®éœ€è¦ä¿®æ”¹å·¥ä½œæµ
vim advanced_api_tests/config/workflow.yaml
```

### ç¬¬å››æ­¥ï¼šè¿è¡Œé«˜çº§æµ‹è¯•
```bash
cd advanced_api_tests
python tests/generated/test_api.py
```

## ğŸ“Š ç”Ÿæˆçš„å¤šæ ¼å¼æ–‡ä»¶

### Pythonæµ‹è¯•æ–‡ä»¶
```python
class AdvancedAPITest(BaseTest):
    def __init__(self):
        super().__init__()
        self.auth_manager = AuthManager("config/auth.yaml")
        self.dependency_manager = DependencyManager()
    
    def test_user_workflow(self):
        # 1. æ‰§è¡Œè®¤è¯
        auth_headers = self.auth_manager.get_auth_headers("api_auth")
        
        # 2. æ‰§è¡Œä¾èµ–å·¥ä½œæµ
        success = self.dependency_manager.execute_workflow("user_workflow")
        
        # 3. éªŒè¯ç»“æœ
        assert success, "å·¥ä½œæµæ‰§è¡Œå¤±è´¥"
```

### Postmané›†åˆ
```json
{
  "info": {
    "name": "APIè‡ªåŠ¨åŒ–æµ‹è¯•é›†åˆ",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/"
  },
  "auth": {
    "type": "bearer",
    "bearer": [{"key": "token", "value": "{{auth_token}}"}]
  },
  "item": [...]
}
```

### cURLè„šæœ¬
```bash
#!/bin/bash
# APIæµ‹è¯•è„šæœ¬

# 1. ç”¨æˆ·ç™»å½•è·å–Token
TOKEN=$(curl -s -X POST "$BASE_URL/auth/login" \
  -H "Content-Type: application/json" \
  -d '{"username":"test","password":"test123"}' \
  | jq -r '.token')

# 2. ä½¿ç”¨Tokenè®¿é—®å—ä¿æŠ¤æ¥å£
curl -X GET "$BASE_URL/user/profile" \
  -H "Authorization: Bearer $TOKEN"
```

## âš ï¸ å®‰å…¨å’Œæœ€ä½³å®è·µ

### 1. æ•æ„Ÿä¿¡æ¯ä¿æŠ¤
- ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨å¯†ç å’ŒAPIå¯†é’¥
- ä¸è¦å°†åŒ…å«æ•æ„Ÿä¿¡æ¯çš„é…ç½®æ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
- å®šæœŸè½®æ¢APIå¯†é’¥å’Œå¯†ç 

### 2. ä¾èµ–ç®¡ç†ç­–ç•¥
- ä¸ºCRUDæ“ä½œå»ºç«‹æ­£ç¡®çš„ä¾èµ–å…³ç³»
- å®ç°æ™ºèƒ½é‡è¯•æœºåˆ¶å¤„ç†ç½‘ç»œæ³¢åŠ¨
- æ·»åŠ æ•°æ®æ¸…ç†æ­¥éª¤é¿å…æµ‹è¯•æ•°æ®æ±¡æŸ“

### 3. é…ç½®ç®¡ç†
- ä¸ºä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒçš„è®¤è¯é…ç½®
- å®æ–½æµ‹è¯•æ•°æ®éš”ç¦»
- å»ºç«‹ç›‘æ§æœºåˆ¶åŠæ—¶å‘ç°APIå˜æ›´

## ğŸ¯ å®æˆ˜æ¡ˆä¾‹

### æ¡ˆä¾‹1ï¼šç”µå•†APIæµ‹è¯•
```yaml
# ç”µå•†å¹³å°å®Œæ•´å·¥ä½œæµ
workflow:
  scenarios:
    - name: "ecommerce_workflow"
      steps:
        - id: "user_login"
          # ç”¨æˆ·ç™»å½•è·å–Token
        - id: "browse_products"
          # æµè§ˆå•†å“ï¼ˆéœ€è¦è®¤è¯ï¼‰
        - id: "add_to_cart"
          # æ·»åŠ åˆ°è´­ç‰©è½¦ï¼ˆä¾èµ–å•†å“æ•°æ®ï¼‰
        - id: "create_order"
          # åˆ›å»ºè®¢å•ï¼ˆä¾èµ–è´­ç‰©è½¦æ•°æ®ï¼‰
        - id: "pay_order"
          # æ”¯ä»˜è®¢å•ï¼ˆä¾èµ–è®¢å•æ•°æ®ï¼‰
        - id: "check_order_status"
          # æŸ¥è¯¢è®¢å•çŠ¶æ€ï¼ˆä¾èµ–æ”¯ä»˜ç»“æœï¼‰
```

### æ¡ˆä¾‹2ï¼šéœ€è¦å¤šæ­¥è®¤è¯çš„API
```yaml
# å¤šæ­¥è®¤è¯åœºæ™¯
authentication:
  two_factor_auth:
    type: "custom"
    steps:
      - login_with_password
      - verify_sms_code
      - get_final_token
```

## ğŸš€ é«˜çº§æŠ€å·§

### 1. åŠ¨æ€æ•°æ®ç”Ÿæˆ
```python
# ä½¿ç”¨AIç”Ÿæˆæµ‹è¯•æ•°æ®
self.test_data["email"] = generate_test_email()
self.test_data["phone"] = generate_test_phone()
```

### 2. æ¡ä»¶æ‰§è¡Œ
```yaml
# æ ¹æ®ç¯å¢ƒæ‰§è¡Œä¸åŒæ­¥éª¤
- id: "admin_operations"
  condition: "${environment} == 'test'"
  # åªåœ¨æµ‹è¯•ç¯å¢ƒæ‰§è¡Œç®¡ç†å‘˜æ“ä½œ
```

### 3. å¹¶è¡Œæ‰§è¡Œ
```yaml
# æ”¯æŒå¹¶è¡Œæ‰§è¡Œçš„ç‹¬ç«‹æ­¥éª¤
parallel_groups:
  - ["get_user_info", "get_user_orders", "get_user_favorites"]
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚éœ€æ›´å¤šå¸®åŠ©ï¼š
1. æŸ¥çœ‹å®Œæ•´æ–‡æ¡£ï¼šREADME.md
2. æŸ¥çœ‹ç¤ºä¾‹é¡¹ç›®ï¼šexamples/ ç›®å½•
3. è¿è¡Œæ¼”ç¤ºï¼špython3 quick_test_jsonplaceholder.py
4. æŸ¥çœ‹ç”Ÿæˆçš„é¡¹ç›®ï¼šjsonplaceholder_automation/

---

ğŸ‰ **æ­å–œï¼æ‚¨ç°åœ¨æ‹¥æœ‰äº†ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„é«˜çº§æ¥å£è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶ï¼**