# åŒºå—é“¾ç¯å¢ƒæ­å»ºæŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨æ­å»ºåŒºå—é“¾æµ‹è¯•ç¯å¢ƒï¼Œæ”¯æŒä»¥å¤ªåŠã€æ¯”ç‰¹å¸ç­‰ä¸»æµåŒºå—é“¾ç½‘ç»œçš„æµ‹è¯•ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate

# å®‰è£…åŒºå—é“¾ä¾èµ–
pip install web3>=6.0.0 eth-account>=0.8.0 bitcoin>=1.1.42 pycryptodome>=3.18.0 mnemonic>=0.20
```

### 2. é…ç½®ç½‘ç»œè¿æ¥

ç¼–è¾‘ `config/blockchain.yaml` æ–‡ä»¶ï¼š

```yaml
default_network: ethereum
default_env: sepolia

networks:
  ethereum:
    sepolia:
      name: "Ethereum Sepolia Testnet"
      rpc_url: "https://sepolia.infura.io/v3/YOUR_KEY"
      chain_id: 11155111
      explorer_url: "https://sepolia.etherscan.io"
      is_testnet: true
      gas_price_gwei: 1.0

  bitcoin:
    testnet:
      name: "Bitcoin Testnet"
      rpc_url: "http://user:pass@localhost:18332"
      explorer_url: "https://blockstream.info/testnet"
      is_testnet: true
```

### 3. è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰åŒºå—é“¾æµ‹è¯•
python3 scripts/test_blockchain.py --all

# æµ‹è¯•ç‰¹å®šç½‘ç»œ
python3 scripts/test_blockchain.py --network ethereum --env sepolia

# æµ‹è¯•é’±åŒ…åŠŸèƒ½
python3 scripts/test_blockchain.py --wallet-test
```

## ğŸŒ æ”¯æŒçš„åŒºå—é“¾ç½‘ç»œ

### ä»¥å¤ªåŠç”Ÿæ€

#### ä¸»ç½‘
- **Ethereum Mainnet**
  - RPC: `https://mainnet.infura.io/v3/YOUR_KEY`
  - Chain ID: 1
  - Explorer: https://etherscan.io

- **BSC Mainnet**
  - RPC: `https://bsc-dataseed.binance.org`
  - Chain ID: 56
  - Explorer: https://bscscan.com

- **Polygon Mainnet**
  - RPC: `https://polygon-rpc.com`
  - Chain ID: 137
  - Explorer: https://polygonscan.com

#### æµ‹è¯•ç½‘
- **Ethereum Sepolia**
  - RPC: `https://sepolia.infura.io/v3/YOUR_KEY`
  - Chain ID: 11155111
  - Explorer: https://sepolia.etherscan.io

- **BSC Testnet**
  - RPC: `https://data-seed-prebsc-1-s1.binance.org:8545`
  - Chain ID: 97
  - Explorer: https://testnet.bscscan.com

### æ¯”ç‰¹å¸ç½‘ç»œ

#### ä¸»ç½‘
- **Bitcoin Mainnet**
  - RPC: `http://localhost:8332`
  - Explorer: https://blockstream.info

#### æµ‹è¯•ç½‘
- **Bitcoin Testnet**
  - RPC: `http://localhost:18332`
  - Explorer: https://blockstream.info/testnet

- **Bitcoin Regtest**
  - RPC: `http://localhost:18443`
  - Explorer: Local

## ğŸ”§ ç¯å¢ƒæ­å»º

### ä»¥å¤ªåŠèŠ‚ç‚¹æ­å»º

#### ä½¿ç”¨ Infura/Alchemyï¼ˆæ¨èï¼‰

1. æ³¨å†Œè´¦æˆ·ï¼š
   - [Infura](https://infura.io/)
   - [Alchemy](https://www.alchemy.com/)

2. åˆ›å»ºé¡¹ç›®è·å–APIå¯†é’¥

3. é…ç½®RPC URLï¼š
   ```
   https://sepolia.infura.io/v3/YOUR_PROJECT_ID
   ```

#### æœ¬åœ°èŠ‚ç‚¹æ­å»º

ä½¿ç”¨ Docker è¿è¡Œä»¥å¤ªåŠèŠ‚ç‚¹ï¼š

```bash
# è¿è¡Œ Sepolia æµ‹è¯•ç½‘èŠ‚ç‚¹
docker run -d \
  --name ethereum-sepolia \
  -p 8545:8545 \
  -v ethereum-data:/root/.ethereum \
  ethereum/client-go:latest \
  --sepolia \
  --http \
  --http.addr 0.0.0.0 \
  --http.api eth,net,web3,personal,admin \
  --syncmode light
```

### æ¯”ç‰¹å¸èŠ‚ç‚¹æ­å»º

#### ä½¿ç”¨ Docker è¿è¡Œ Bitcoin Core

```bash
# è¿è¡Œ Bitcoin Testnet èŠ‚ç‚¹
docker run -d \
  --name bitcoin-testnet \
  -p 18332:18332 \
  -p 18333:18333 \
  -v bitcoin-data:/home/bitcoin/.bitcoin \
  ruimarinho/bitcoin-core:latest \
  -testnet \
  -rpcallowip=0.0.0.0/0 \
  -rpcbind=0.0.0.0 \
  -rpcuser=user \
  -rpcpassword=password \
  -server \
  -txindex
```

#### æœ¬åœ°å®‰è£… Bitcoin Core

```bash
# macOS
brew install bitcoin

# å¯åŠ¨æµ‹è¯•ç½‘èŠ‚ç‚¹
bitcoind -testnet -server -rpcuser=user -rpcpassword=password
```

## ğŸ’° è·å–æµ‹è¯•å¸

### ä»¥å¤ªåŠæµ‹è¯•å¸

#### Sepolia æµ‹è¯•ç½‘
- [Sepolia Faucet](https://sepoliafaucet.com/)
- [Alchemy Faucet](https://sepoliafaucet.com/)

#### Goerli æµ‹è¯•ç½‘ï¼ˆå·²åºŸå¼ƒï¼‰
- æ³¨æ„ï¼šGoerli æµ‹è¯•ç½‘å·²åºŸå¼ƒï¼Œå»ºè®®ä½¿ç”¨ Sepolia

### æ¯”ç‰¹å¸æµ‹è¯•å¸

#### æµ‹è¯•ç½‘æ°´é¾™å¤´
- [Bitcoin Testnet Faucet](https://testnet-faucet.mempool.co/)
- [Coinfaucet](https://coinfaucet.eu/en/btc-testnet/)

## ğŸ”‘ é’±åŒ…ç®¡ç†

### åˆ›å»ºé’±åŒ…

```python
from src.blockchain import WalletManager

# åˆ›å»ºé’±åŒ…ç®¡ç†å™¨
wallet_manager = WalletManager()

# åˆ›å»ºä»¥å¤ªåŠé’±åŒ…
eth_wallet = await wallet_manager.create_wallet("ethereum", "æˆ‘çš„é’±åŒ…")

# åˆ›å»ºæ¯”ç‰¹å¸é’±åŒ…
btc_wallet = await wallet_manager.create_wallet("bitcoin", "æˆ‘çš„é’±åŒ…")

print(f"ä»¥å¤ªåŠåœ°å€: {eth_wallet.address}")
print(f"æ¯”ç‰¹å¸åœ°å€: {btc_wallet.address}")
```

### å¯¼å…¥ç§é’¥

```python
# å¯¼å…¥ä»¥å¤ªåŠç§é’¥
private_key = "0x..."
wallet = await wallet_manager.import_private_key(private_key, "ethereum")
```

### å¯¼å…¥åŠ©è®°è¯

```python
# å¯¼å…¥åŠ©è®°è¯
mnemonic = "abandon abandon abandon..."
wallet = await wallet_manager.import_mnemonic(mnemonic, "ethereum")
```

## ğŸ“ æ™ºèƒ½åˆçº¦æµ‹è¯•

### éƒ¨ç½²åˆçº¦

```python
from src.blockchain import EthereumClient, SmartContractTester

# åˆ›å»ºå®¢æˆ·ç«¯
client = EthereumClient(rpc_url, private_key)
tester = SmartContractTester(client)

# éƒ¨ç½²åˆçº¦
report = await tester.run_comprehensive_test(abi, bytecode)
```

### æµ‹è¯•åˆçº¦æ–¹æ³•

```python
# æµ‹è¯•åˆçº¦æ–¹æ³•
results = await tester.test_contract_methods(contract_address, abi)
```

## ğŸŒ è·¨é“¾æµ‹è¯•

### ä½¿ç”¨åŒºå—é“¾ç®¡ç†å™¨

```python
from src.blockchain import BlockchainManager

# åˆ›å»ºç®¡ç†å™¨
manager = BlockchainManager()

# æ·»åŠ ç½‘ç»œ
await manager.add_network("ethereum_sepolia", {
    "type": "ethereum",
    "rpc_url": "https://sepolia.infura.io/v3/YOUR_KEY",
    "is_testnet": True
})

# è¿è¡Œè·¨é“¾æµ‹è¯•
results = await manager.run_cross_chain_test()
```

## ğŸ”’ å®‰å…¨æ³¨æ„äº‹é¡¹

### ç§é’¥å®‰å…¨

1. **æ°¸è¿œä¸è¦æäº¤ç§é’¥åˆ°ç‰ˆæœ¬æ§åˆ¶**
2. **ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨æ•æ„Ÿä¿¡æ¯**
3. **åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ç¡¬ä»¶é’±åŒ…**

```bash
# ä½¿ç”¨ç¯å¢ƒå˜é‡
export ETHEREUM_PRIVATE_KEY="0x..."
export BITCOIN_RPC_PASSWORD="password"
```

### æµ‹è¯•ç½‘ä½¿ç”¨

1. **åªä½¿ç”¨æµ‹è¯•ç½‘è¿›è¡Œå¼€å‘æµ‹è¯•**
2. **ä¸è¦åœ¨ä¸»ç½‘ä½¿ç”¨æµ‹è¯•ä»£ç **
3. **å®šæœŸæ¸…ç†æµ‹è¯•æ•°æ®**

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### è¿æ¥æ± é…ç½®

```python
# é…ç½®è¿æ¥æ± 
from web3 import Web3
from web3.middleware import geth_poa_middleware

w3 = Web3(Web3.HTTPProvider(rpc_url, request_kwargs={'timeout': 30}))
w3.middleware_onion.inject(geth_poa_middleware, layer=0)
```

### æ‰¹é‡æ“ä½œ

```python
# æ‰¹é‡åˆ›å»ºé’±åŒ…
wallets = []
for i in range(100):
    wallet = await wallet_manager.create_wallet("ethereum")
    wallets.append(wallet)
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. è¿æ¥è¶…æ—¶

```
é”™è¯¯: Connection timeout
è§£å†³: æ£€æŸ¥ç½‘ç»œè¿æ¥å’ŒRPC URL
```

#### 2. ç§é’¥æ ¼å¼é”™è¯¯

```
é”™è¯¯: Invalid private key format
è§£å†³: ç¡®ä¿ç§é’¥ä»¥0xå¼€å¤´ï¼Œé•¿åº¦ä¸º66å­—ç¬¦
```

#### 3. Gasè´¹ä¸è¶³

```
é”™è¯¯: Insufficient gas
è§£å†³: å¢åŠ Gasé™åˆ¶æˆ–Gasä»·æ ¼
```

#### 4. éceä½™é¢ä¸è¶³

```
é”™è¯¯: Insufficient balance
è§£å†³: ä»æ°´é¾™å¤´è·å–æµ‹è¯•å¸
```

### è°ƒè¯•æ¨¡å¼

```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
python3 scripts/test_blockchain.py --all --verbose
```

## ğŸ“š è¿›é˜¶åŠŸèƒ½

### è‡ªå®šä¹‰åŒºå—é“¾æ”¯æŒ

```python
# æ·»åŠ è‡ªå®šä¹‰åŒºå—é“¾
custom_config = {
    "type": "ethereum",
    "rpc_url": "https://custom-rpc.com",
    "chain_id": 999,
    "is_testnet": True
}

await manager.add_network("custom_chain", custom_config)
```

### äº‹ä»¶ç›‘å¬

```python
# ç›‘å¬åˆçº¦äº‹ä»¶
async def event_callback(event):
    print(f"æ”¶åˆ°äº‹ä»¶: {event}")

await client.listen_events(contract_address, abi, "Transfer", event_callback)
```

### å¤šé‡ç­¾åé’±åŒ…

```python
# åˆ›å»ºå¤šç­¾é’±åŒ…ï¼ˆéœ€è¦é¢å¤–é…ç½®ï¼‰
multisig_wallet = await wallet_manager.create_multisig_wallet(
    signers=["0x...", "0x..."],
    threshold=2,
    blockchain_type="ethereum"
)
```

## ğŸ“– å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£

- [Web3.py Documentation](https://web3py.readthedocs.io/)
- [Ethereum Developer Resources](https://ethereum.org/developers/)
- [Bitcoin Developer Documentation](https://developer.bitcoin.org/)

### æµ‹è¯•å·¥å…·

- [Remix IDE](https://remix.ethereum.org/) - æ™ºèƒ½åˆçº¦å¼€å‘
- [MetaMask](https://metamask.io/) - æµè§ˆå™¨é’±åŒ…
- [MyEtherWallet](https://www.myetherwallet.com/) - åœ¨çº¿é’±åŒ…

### åŒºå—é“¾æµè§ˆå™¨

- [Etherscan](https://etherscan.io/) - ä»¥å¤ªåŠæµè§ˆå™¨
- [BSCScan](https://bscscan.com/) - BSCæµè§ˆå™¨
- [Blockstream](https://blockstream.info/) - æ¯”ç‰¹å¸æµè§ˆå™¨

---

**æ³¨æ„**: æœ¬æŒ‡å—ä»…ç”¨äºå¼€å‘å’Œæµ‹è¯•ç›®çš„ï¼Œè¯·å‹¿åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨æµ‹è¯•ä»£ç å’Œç§é’¥ã€‚
