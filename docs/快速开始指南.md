# 接口自动化测试框架 - 快速开始指南

## 🚀 5分钟快速上手

### 第一步：安装框架
```bash
# 克隆项目
git clone <repository-url>
cd interface_autotest

# 安装依赖
pip install -r requirements.txt

# 安装框架
pip install -e .

# 验证安装
autotest --help
```

### 第二步：配置AI功能（可选）
```bash
# 设置DeepSeek API Key
autotest ai setup --api-key sk-your-deepseek-api-key

# 验证AI配置
autotest ai health-check
```

### 第三步：生成测试用例
```bash
# 从API文档生成测试
autotest generate tests -i api.yaml -o tests/

# 使用AI增强生成
autotest ai test-generate -i api.yaml -o ai_tests/ --business-context "电商平台API"
```

### 第四步：执行测试
```bash
# 运行测试
autotest run tests --path tests/ --parallel 4

# 生成报告
autotest run tests --path tests/ --format html,json --output reports/
```

### 第五步：查看结果
```bash
# 查看HTML报告
open reports/test_report_*.html

# 查看测试统计
autotest analyze summary --test-results reports/
```

## 📋 详细安装步骤

### 环境要求
- Python 3.8+
- pip 包管理器
- 网络连接（用于下载依赖和AI API调用）

### 系统依赖
```bash
# Ubuntu/Debian
sudo apt-get update
sudo apt-get install python3 python3-pip python3-venv

# CentOS/RHEL
sudo yum install python3 python3-pip

# macOS
brew install python3
```

### 虚拟环境安装（推荐）
```bash
# 创建虚拟环境
python3 -m venv venv

# 激活虚拟环境
# Linux/macOS
source venv/bin/activate
# Windows
venv\Scripts\activate

# 安装依赖
pip install -r requirements.txt
pip install -e .
```

### 验证安装
```bash
# 检查版本
autotest --version

# 查看帮助
autotest --help

# 检查配置
autotest config show
```

## 🎯 使用场景示例

### 场景1：新项目快速开始
```bash
# 1. 准备API文档
cp your-api.yaml api.yaml

# 2. 一键生成完整测试
autotest generate auto-complete -i api.yaml -o project_tests/

# 3. 执行测试
autotest run tests --path project_tests/ --format html

# 4. 查看报告
open reports/test_report_*.html
```

### 场景2：AI增强测试
```bash
# 1. 配置AI
autotest ai setup --api-key sk-your-key

# 2. AI分析API文档
autotest ai-wizard analyze-api -i api.yaml

# 3. AI生成智能测试
autotest ai-wizard auto-test -i api.yaml -o ai_tests/

# 4. AI代码审查
autotest ai review-code -f ai_tests/ -o review.md
```

### 场景3：Mock服务器测试
```bash
# 1. 启动Mock服务器
autotest mock start --port 8080 --enable-cors

# 2. 添加Mock路由
curl -X POST http://localhost:8080/_mock/routes \
  -H "Content-Type: application/json" \
  -d '{"method": "GET", "path": "/api/users", "response": {"status_code": 200, "body": {"users": []}}}'

# 3. 运行测试（使用Mock）
autotest run tests --path tests/ --env mock
```

### 场景4：性能测试
```bash
# 1. 生成性能测试
autotest generate tests -i api.yaml -o tests/ --include-performance

# 2. 执行并发测试
autotest run tests --path tests/ --parallel 10 --timeout 30

# 3. 分析性能报告
autotest analyze performance --test-results reports/
```

## 🔧 配置管理

### 基础配置
```yaml
# config/default.yaml
global:
  timeout: 30
  retry: 3
  parallel: 4
  keep_alive: true

environments:
  dev:
    base_url: "http://localhost:8080"
    headers:
      Content-Type: "application/json"
  
  test:
    base_url: "http://test-api.example.com"
    headers:
      Authorization: "Bearer test-token"

ai:
  deepseek_api_key: "sk-your-api-key"
  model: "deepseek-chat"
```

### 环境变量配置
```bash
# 设置API Key
export DEEPSEEK_API_KEY="sk-your-deepseek-api-key"

# 设置环境
export AUTOTEST_ENV="test"

# 设置日志级别
export AUTOTEST_LOG_LEVEL="INFO"
```

### 配置文件管理
```bash
# 查看当前配置
autotest config show

# 切换环境
autotest config switch test

# 设置配置值
autotest config set global.timeout 60

# 保存配置
autotest config save
```

## 🛠️ 常用命令速查

### 基础命令
```bash
# 帮助信息
autotest --help
autotest <command> --help

# 版本信息
autotest --version

# 配置管理
autotest config show
autotest config switch <env>
autotest config set <key> <value>
```

### 测试生成
```bash
# 基础生成
autotest generate tests -i <input> -o <output>

# 高级生成
autotest generate advanced -i <input> -o <output> --include-auth --include-workflow

# AI生成
autotest ai test-generate -i <input> -o <output> --business-context "业务描述"
```

### 测试执行
```bash
# 基础执行
autotest run tests --path <path>

# 并发执行
autotest run tests --path <path> --parallel 4

# 生成报告
autotest run tests --path <path> --format html,json,xml --output reports/
```

### Mock服务器
```bash
# 启动服务
autotest mock start --port 8080

# 管理路由
curl http://localhost:8080/_mock/routes
curl -X POST http://localhost:8080/_mock/routes -d '{"method": "GET", "path": "/api/test", "response": {"status_code": 200}}'

# 停止服务
autotest mock stop
```

### AI功能
```bash
# 配置AI
autotest ai setup --api-key <key>

# 健康检查
autotest ai health-check

# 智能向导
autotest ai-wizard analyze-api -i <input>
autotest ai-wizard auto-test -i <input> -o <output>
```

## 🚨 常见问题解决

### 安装问题
```bash
# 问题：pip安装失败
# 解决：升级pip
pip install --upgrade pip

# 问题：依赖冲突
# 解决：使用虚拟环境
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### 配置问题
```bash
# 问题：找不到配置文件
# 解决：创建默认配置
autotest config init

# 问题：API Key无效
# 解决：重新配置
autotest ai setup --api-key <new-key>
```

### 执行问题
```bash
# 问题：测试执行失败
# 解决：检查网络连接和API可用性
autotest run tests --path tests/ --debug

# 问题：Mock服务器启动失败
# 解决：检查端口占用
lsof -i :8080
autotest mock start --port 8081
```

## 📚 进阶使用

### 自定义测试类
```python
from src.core.base_test import BaseTest

class CustomAPITest(BaseTest):
    def test_custom_endpoint(self):
        """自定义测试方法"""
        result = self.make_request(
            method='GET',
            url='/api/custom',
            test_name='test_custom_endpoint'
        )
        
        self.assert_status_code(result, 200)
        self.assert_response_time(result.response_time, 'GET')
        
        return result
```

### 自定义配置
```python
from src.utils.config_loader import ConfigLoader

# 加载自定义配置
config = ConfigLoader('custom_config.yaml')
config.set_environment('production')

# 使用配置
base_url = config.get_base_url()
headers = config.get_headers()
```

### 性能监控
```python
from src.utils.performance_monitor import monitor_performance

@monitor_performance
def my_function():
    """被监控的函数"""
    # 函数逻辑
    pass

# 获取性能统计
monitor = get_global_monitor()
stats = monitor.get_performance_summary()
```

## 🎉 下一步

现在您已经掌握了框架的基础使用方法，可以：

1. **阅读详细文档**: 查看 `docs/` 目录下的详细文档
2. **探索AI功能**: 尝试使用AI增强的测试生成功能
3. **集成CI/CD**: 将框架集成到您的CI/CD流水线中
4. **自定义扩展**: 根据需求开发自定义的解析器或导出器
5. **性能优化**: 根据监控数据优化测试性能

## 📞 获取帮助

- 📖 **文档**: 查看 `docs/` 目录
- 🐛 **问题报告**: 在GitHub上提交Issue
- 💬 **讨论**: 参与GitHub Discussions
- 📧 **联系**: 发送邮件到项目维护者

祝您使用愉快！🚀
