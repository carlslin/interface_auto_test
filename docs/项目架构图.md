# 接口自动化测试框架 - 项目架构图

## 整体架构图

```mermaid
graph TB
    subgraph "用户交互层"
        CLI[CLI命令行界面]
        WebUI[Web管理界面]
        API[API接口]
    end
    
    subgraph "AI智能化层 (L4)"
        Chat[AI聊天助手]
        Decision[AI决策中心]
    end
    
    subgraph "智能分析层 (L3)"
        Completion[AI补全管理器]
        Reporter[AI测试报告器]
    end
    
    subgraph "基础AI层 (L2)"
        Generator[AI测试生成器]
        Client[DeepSeek客户端]
    end
    
    subgraph "核心功能层"
        Parser[文档解析器]
        Runner[测试运行器]
        Mock[Mock服务器]
        Exporter[导出器]
    end
    
    subgraph "基础设施层"
        Config[配置管理]
        Security[安全管理]
        Cache[缓存管理]
        Monitor[性能监控]
        Data[数据管理]
    end
    
    subgraph "外部服务"
        DeepSeek[DeepSeek AI API]
        Redis[Redis缓存]
        FileSystem[文件系统]
    end
    
    CLI --> Chat
    CLI --> Decision
    CLI --> Completion
    CLI --> Generator
    CLI --> Parser
    CLI --> Runner
    CLI --> Mock
    CLI --> Exporter
    
    Chat --> Decision
    Decision --> Completion
    Completion --> Generator
    Generator --> Client
    
    Parser --> Config
    Runner --> Config
    Mock --> Config
    Exporter --> Config
    
    Client --> DeepSeek
    Cache --> Redis
    Monitor --> FileSystem
    Data --> FileSystem
    
    Security --> Config
    Cache --> Config
    Monitor --> Config
```

## 模块依赖关系图

```mermaid
graph LR
    subgraph "src/"
        subgraph "cli/"
            main[main.py]
            advanced[advanced_generator.py]
            ai_cmd[ai_*.py]
        end
        
        subgraph "ai/"
            client[deepseek_client.py]
            generator[ai_test_generator.py]
            reporter[ai_test_reporter.py]
            completion[ai_completion_manager.py]
            decision[ai_decision_center.py]
            chat[ai_chat_assistant.py]
        end
        
        subgraph "core/"
            base[base_test.py]
            request[request_handler.py]
            async_request[async_request_handler.py]
            executor[test_executor.py]
        end
        
        subgraph "utils/"
            config[config_loader.py]
            security[security_manager.py]
            cache[cache_manager.py]
            monitor[performance_monitor.py]
            data[data_manager.py]
            faker[data_faker.py]
            validator[validator.py]
        end
        
        subgraph "parsers/"
            openapi[openapi_parser.py]
            postman[postman_parser.py]
            custom[custom_parser.py]
        end
        
        subgraph "runners/"
            runner[test_runner.py]
            intelligent[intelligent_test_runner.py]
            report[report_generator.py]
        end
        
        subgraph "mock/"
            server[mock_server.py]
            data[mock_data.py]
        end
        
        subgraph "exporters/"
            exporter[test_case_exporter.py]
        end
        
        subgraph "auth/"
            auth[auth_manager.py]
        end
        
        subgraph "workflow/"
            dependency[dependency_manager.py]
        end
    end
    
    main --> client
    main --> generator
    main --> config
    main --> security
    
    client --> security
    generator --> client
    reporter --> client
    completion --> generator
    decision --> client
    chat --> decision
    
    base --> request
    base --> config
    request --> security
    async_request --> security
    executor --> base
    
    config --> security
    cache --> security
    monitor --> security
    data --> security
    
    openapi --> config
    postman --> config
    custom --> config
    
    runner --> base
    intelligent --> decision
    report --> runner
    
    server --> config
    data --> config
    
    exporter --> config
    
    auth --> security
    
    dependency --> config
```

## 数据流图

```mermaid
flowchart TD
    Start([开始]) --> Input[API文档输入]
    Input --> Parse[文档解析]
    Parse --> Validate[格式验证]
    Validate --> Generate[AI测试生成]
    Generate --> Execute[测试执行]
    Execute --> Report[报告生成]
    Report --> Export[结果导出]
    Export --> End([结束])
    
    subgraph "AI增强流程"
        Generate --> AI1[智能分析]
        AI1 --> AI2[场景生成]
        AI2 --> AI3[数据生成]
        AI3 --> AI4[断言优化]
    end
    
    subgraph "性能优化"
        Execute --> Cache[缓存检查]
        Cache --> Async[异步执行]
        Async --> Monitor[性能监控]
    end
    
    subgraph "安全防护"
        Input --> Security1[输入验证]
        Security1 --> Security2[数据清理]
        Security2 --> Security3[敏感信息加密]
    end
```

## 部署架构图

```mermaid
graph TB
    subgraph "开发环境"
        Dev[开发机器]
        DevConfig[开发配置]
        DevData[开发数据]
    end
    
    subgraph "测试环境"
        Test[测试服务器]
        TestConfig[测试配置]
        TestData[测试数据]
    end
    
    subgraph "生产环境"
        Prod[生产服务器]
        ProdConfig[生产配置]
        ProdData[生产数据]
    end
    
    subgraph "外部服务"
        DeepSeekAPI[DeepSeek API]
        RedisCluster[Redis集群]
        FileStorage[文件存储]
    end
    
    Dev --> Test
    Test --> Prod
    
    Dev --> DeepSeekAPI
    Test --> DeepSeekAPI
    Prod --> DeepSeekAPI
    
    Dev --> RedisCluster
    Test --> RedisCluster
    Prod --> RedisCluster
    
    Dev --> FileStorage
    Test --> FileStorage
    Prod --> FileStorage
```

## 技术栈图

```mermaid
graph LR
    subgraph "前端技术"
        CLI[Click CLI]
        Web[Flask Web]
    end
    
    subgraph "后端技术"
        Python[Python 3.8+]
        Async[AsyncIO]
        Thread[Threading]
    end
    
    subgraph "AI技术"
        DeepSeek[DeepSeek API]
        OpenAI[OpenAI兼容]
    end
    
    subgraph "数据存储"
        SQLite[SQLite]
        Redis[Redis]
        File[文件系统]
    end
    
    subgraph "网络技术"
        HTTP[HTTP/HTTPS]
        WebSocket[WebSocket]
        REST[REST API]
    end
    
    subgraph "安全技术"
        Crypto[加密算法]
        Auth[认证授权]
        Validation[输入验证]
    end
    
    CLI --> Python
    Web --> Python
    Python --> Async
    Python --> Thread
    Python --> DeepSeek
    Python --> SQLite
    Python --> Redis
    Python --> HTTP
    Python --> Crypto
```

## 优化后的架构特点

### 🏗️ 四层智能化架构
- **L1 基础AI功能**: DeepSeek客户端、测试生成器、报告生成器
- **L2 智能分析**: AI补全管理器、统一协调
- **L3 智能决策**: AI决策中心、自适应推荐
- **L4 智能交互**: AI聊天助手、自然语言交互

### 🔒 安全增强
- 敏感信息加密存储
- 输入验证和数据清理
- SQL注入和XSS防护
- 安全配置管理

### ⚡ 性能优化
- 异步HTTP请求处理
- 内存和Redis缓存
- 并发测试执行
- 性能监控和指标收集

### 📊 监控体系
- 实时性能监控
- 系统资源监控
- 错误率统计
- 性能报告生成

### 🛠️ 可扩展性
- 模块化设计
- 插件化架构
- 配置驱动
- 多环境支持
